<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>test</title>

    <link
      rel="stylesheet"
      href="http://192.168.137.113/arcgis_js_api/library/4.18/esri/themes/light/main.css"
    />
    <script src="http://192.168.137.113/arcgis_js_api/library/4.18/init.js"></script>

    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>

    <script>
      require([
        "esri/Map",
        "esri/views/MapView",
        "esri/layers/MapImageLayer",
        "esri/layers/FeatureLayer",
      ], function (Map, MapView, MapImageLayer, FeatureLayer) {
        var imagePopupTemplate = {
          //设置popup弹出框
          title: "建筑物",
          content: [
            {
              type: "fields",
              fieldInfos: [
                {
                  fieldName: "OBJECTID",
                  label: "OBJECTID",
                  type: "oid",
                },
                {
                  fieldName: "SHAPE",
                  label: "SHAPE",
                  type: "geometry",
                },
                {
                  fieldName: "GLID",
                  label: "GLID",
                  type: "string",
                },
                {
                  fieldName: "SHAPE_Length",
                  label: "SHAPE_Length",
                  type: "double",
                },
                {
                  fieldName: "SHAPE_Area",
                  label: "SHAPE_Area",
                  type: "double",
                },
                {
                  fieldName: "JZWMC",
                  label: "JZWMC",
                  type: "string",
                },
                {
                  fieldName: "JZWLX",
                  label: "JZWLX",
                  type: "string",
                },
              ],
            },
          ],
        };
        var imageLayer = new MapImageLayer({
          url: "http://192.168.137.113/server/rest/services/20210129二维矢量地图/MapServer",
          sublayers: [
            {
              id: 0,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 1,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 2,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 3,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 4,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 5,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 6,
              popupTemplate: imagePopupTemplate,
            },
            {
              id: 7,
              popupTemplate: imagePopupTemplate,
            },
          ],
        });
        var map = new Map({
          layers: [imageLayer],
        });
        var view = new MapView({
          container: "viewDiv",
          map: map,
          zoom: 4,
          scale: 16000,
          center: [114.40776, 30.51415],
        });
        var featureLayerRenderer = {
          type: "simple",
          symbol: {
            type: "simple-marker",
            color: "#ffff00",
            size: 6,
          },
        };

        var featureLayer = new FeatureLayer({
          url: "http://192.168.137.113/server/rest/services/20200917AP点位/MapServer/0",
          renderer: featureLayerRenderer, //渲染
          popupTemplate: {
            title: "AP",
            content:[
                {
                    type:"fields",
                    fieldInfos:[
                    {
                            fieldName:"OBJECTID",
                            label:"OBJECTID",
                            type:"oid"
                        },{
                            fieldName:"Shape",
                            label:"Shape",
                            type:"geometry"
                        },{
                            fieldName:"FWBM",
                            label:"FWBM",
                            type:"string"
                        },{
                            fieldName:"LC",
                            label:"LC",
                            type:"string"
                        },{
                            fieldName:"PointGUID",
                            label:"PointGUID",
                            type:"string"
                        },{
                            fieldName:"FJGUID",
                            label:"FJGUID",
                            type:"string"
                        },
                    ]
                }
            ]
          },
        });

        map.add(featureLayer);
      });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
  </body>
</html>
